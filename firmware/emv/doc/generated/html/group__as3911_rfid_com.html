<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AS3911 EMV L1 Certification Firmware: AS3911 RFID Communication</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">AS3911 EMV L1 Certification Firmware</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">AS3911 RFID Communication</div>  </div>
<div class="ingroups"><a class="el" href="group__as3911.html">AS3911</a></div></div>
<div class="contents">

<p>This part of the AS9311 module abstracts Communication with an ISO14443-A or ISO14443-B card including features required for EMV.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_s3911_gain_table__t.html">AS3911GainTable_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Gain adjustment lookup table.  <a href="struct_a_s3911_gain_table__t.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_a_s3911_modulation_level_table__t.html">AS3911ModulationLevelTable_t</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Modulation level adjustment lookup table.  <a href="struct_a_s3911_modulation_level_table__t.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#gae766a917d30b44c1ea06e5462edcef2a">AS3911_TX_MODE_MASK</a>&#160;&#160;&#160;0x30</td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#ga32470d661d8a69007b40eb27eaec270a">AS3911RequestFlags_t</a> { <br/>
&#160;&#160;<a class="el" href="group__as3911_rfid_com.html#gga32470d661d8a69007b40eb27eaec270aa316a0aa780696ddc0c26d2e11ccb3a6b">AS3911_IGNORE_CRC</a> =  0x01, 
<a class="el" href="group__as3911_rfid_com.html#gga32470d661d8a69007b40eb27eaec270aadaace36ce9d80237e0b35318e50e53f2">AS3911_CRC_TO_FIFO</a> =  0x02, 
<a class="el" href="group__as3911_rfid_com.html#gga32470d661d8a69007b40eb27eaec270aa74a61ad6aaecc3cad698b98303c3b47a">AS3911_TRANSMIT_WITH_CRC</a> =  0x00, 
<a class="el" href="group__as3911_rfid_com.html#gga32470d661d8a69007b40eb27eaec270aa5d5ea41fd31378138529c3f5ae62d95d">AS3911_TRANSMIT_WITHOUT_CRC</a> =  0x10, 
<br/>
&#160;&#160;<a class="el" href="group__as3911_rfid_com.html#gga32470d661d8a69007b40eb27eaec270aac9767e939ce3a47803fced5fba7439a5">AS3911_TRANSMIT_REQA</a> =  0x20, 
<a class="el" href="group__as3911_rfid_com.html#gga32470d661d8a69007b40eb27eaec270aa1e872266a5d5bec8fdbeb6fcf0824ae9">AS3911_TRANSMIT_WUPA</a> =  0x30
<br/>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#ga671e939efb1421cb4a1583c12e1d8a43">AS3911GainMode_t</a> { <a class="el" href="group__as3911_rfid_com.html#gga671e939efb1421cb4a1583c12e1d8a43ad7364a5efee4569a97db08a1a95269af">AS3911_GAIN_FIXED</a>, 
<a class="el" href="group__as3911_rfid_com.html#gga671e939efb1421cb4a1583c12e1d8a43a768f873e2062370490a3903d05c22c1f">AS3911_GAIN_FROM_AMPLITUDE</a>, 
<a class="el" href="group__as3911_rfid_com.html#gga671e939efb1421cb4a1583c12e1d8a43a51bd9b23e5e35d6eb360609ea02588f5">AS3911_GAIN_FROM_PHASE</a>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#ga9860369f946c6932c18c7ca07da4351a">AS3911ModulationLevelMode_t</a> { <a class="el" href="group__as3911_rfid_com.html#gga9860369f946c6932c18c7ca07da4351aaef82d2fdbe886a114cdd7f50302a36e2">AS3911_MODULATION_LEVEL_FIXED</a>, 
<a class="el" href="group__as3911_rfid_com.html#gga9860369f946c6932c18c7ca07da4351aabebd3fbbed15281de23f5c4b650ee0e0">AS3911_MODULATION_LEVEL_AUTOMATIC</a>, 
<a class="el" href="group__as3911_rfid_com.html#gga9860369f946c6932c18c7ca07da4351aa7ec5c4a050a4e8c525b8e413562ddad0">AS3911_MODULATION_LEVEL_FROM_AMPLITUDE</a>, 
<a class="el" href="group__as3911_rfid_com.html#gga9860369f946c6932c18c7ca07da4351aafcd0372b3b3ed3685d23f981df8b5e55">AS3911_MODULATION_LEVEL_FROM_PHASE</a>
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#ga2a2791dbde4538fa3c4b1385e965e0f4">as3911EnableEmvExceptionProcessing</a> (bool_t enableEmvExceptionProcessing)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable or disable emv layer 4 exception processing.  <a href="#ga2a2791dbde4538fa3c4b1385e965e0f4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#gaaed8c0af2b459d1a94d13cf8075215c8">as3911EmvExceptionProcessingIsEnabled</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Check EMV exception processing status.  <a href="#gaaed8c0af2b459d1a94d13cf8075215c8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#gaf2d2dc0feff4753677465ac25b69df77">as3911SetTransmissionErrorThreshold</a> (size_t transmissionErrorThreshold)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the transmission error threshold.  <a href="#gaf2d2dc0feff4753677465ac25b69df77"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#gadcc0b5c5239d5d6310784afdfdf4abae">as3911GetTransmissionErrorThreshold</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the transmission error threshold.  <a href="#gadcc0b5c5239d5d6310784afdfdf4abae"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#ga0be2f5f914a6adace78a4b103f514edc">as3911SetFrameDelayTime</a> (u32 frameDelayTime)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the frame delay time.  <a href="#ga0be2f5f914a6adace78a4b103f514edc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">u32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#ga1801b0e48a172ef7b511ee6b425bd774">as3911GetFrameDelayTime</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the frame delay time.  <a href="#ga1801b0e48a172ef7b511ee6b425bd774"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#gaf9dd8ab1205585eb78b26d2d426012e1">as3911SetReceiverDeadtime</a> (u32 receiverDeadtime)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the receiver deadtime.  <a href="#gaf9dd8ab1205585eb78b26d2d426012e1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#ga1468a4d14877ba98080064a0feaea299">as3911SetReceiveTimeout</a> (u32 receiveTimeout)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the receive timeout.  <a href="#ga1468a4d14877ba98080064a0feaea299"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#ga091e236e2616c27fc0dae74830e8128b">as3911Transmit</a> (const u8 *message, size_t messageLength, <a class="el" href="group__as3911_rfid_com.html#ga32470d661d8a69007b40eb27eaec270a">AS3911RequestFlags_t</a> requestFlags)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmit a message with the AS3911.  <a href="#ga091e236e2616c27fc0dae74830e8128b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">s16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#gaaa5ae01bbb3e5f295dd393ebec21c84a">as3911Receive</a> (u8 *response, size_t maxResponseLength, size_t *responseLength)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive a card response.  <a href="#gaaa5ae01bbb3e5f295dd393ebec21c84a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">s16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#gab596cd3ffe9750f715924103a96c8ab6">as3911Transceive</a> (const u8 *request, size_t requestLength, u8 *response, size_t maxResponseLength, size_t *responseLength, u32 timeout, <a class="el" href="group__as3911_rfid_com.html#ga32470d661d8a69007b40eb27eaec270a">AS3911RequestFlags_t</a> requestFlags)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Send an RFID message and receive a card response.  <a href="#gab596cd3ffe9750f715924103a96c8ab6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#gac9b5a16174fa4e610a79c21f4f47e8d6">as3911SetGainMode</a> (<a class="el" href="group__as3911_rfid_com.html#ga671e939efb1421cb4a1583c12e1d8a43">AS3911GainMode_t</a> modulationLevelMode, const <a class="el" href="struct_a_s3911_gain_table__t.html">AS3911GainTable_t</a> *modulationLevelTable)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the modulation level adjustment mode and modulation level adjustment table.  <a href="#gac9b5a16174fa4e610a79c21f4f47e8d6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#gaed0aaed5127ece136aa71cfeb08edd81">as3911GetGainMode</a> (<a class="el" href="group__as3911_rfid_com.html#ga671e939efb1421cb4a1583c12e1d8a43">AS3911GainMode_t</a> *modulationLevelMode, const <a class="el" href="struct_a_s3911_gain_table__t.html">AS3911GainTable_t</a> *modulationLevelTable)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the active modulation level adjustment mode and modulation level adjustment table.  <a href="#gaed0aaed5127ece136aa71cfeb08edd81"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#ga56e33e574960a4ab4572064d8e7dd5e2">as3911AdjustGain</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjust the modulation level.  <a href="#ga56e33e574960a4ab4572064d8e7dd5e2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#gae6c139a8464ba6132483416c2c5617f6">as3911SetModulationLevelMode</a> (<a class="el" href="group__as3911_rfid_com.html#ga9860369f946c6932c18c7ca07da4351a">AS3911ModulationLevelMode_t</a> modulationLevelMode, const void *modulationLevelModeData)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the modulation level adjustment mode and modulation level adjustment table.  <a href="#gae6c139a8464ba6132483416c2c5617f6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#ga23beb860bf4bfcd8ccfe829a6d9433d5">as3911GetModulationLevelMode</a> (<a class="el" href="group__as3911_rfid_com.html#ga9860369f946c6932c18c7ca07da4351a">AS3911ModulationLevelMode_t</a> *modulationLevelMode, const void *modulationLevelModeData)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the active modulation level adjustment mode and modulation level adjustment table.  <a href="#ga23beb860bf4bfcd8ccfe829a6d9433d5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__as3911_rfid_com.html#ga59f2eddf2fefc3ee4b4a9cb46312ec36">as3911AdjustModulationLevel</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjust the modulation level.  <a href="#ga59f2eddf2fefc3ee4b4a9cb46312ec36"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>This part of the AS3911 module consists of functions to configure paramters of the datatarnsmission to and from an RFID card and functions to actually perfrom the transmissions.</p>
<h2><a class="anchor" id="sec_as3911RfidCom_1"></a>
Receiver Deadtime</h2>
<p>After the data transmission from the reader is completed the receivers will be kept disbabled until the receiver dead time has expired. This dead time ensures that the receiver does not pick up noise still present from the transmit operation.</p>
<p>For EMV the standard specifies that the PCD must ignore any load modulation produced by the PICC for a certain time immediately after the completion of the PCD message. The receveiver dead time can be used to implement this EMV deaf time.</p>
<h2><a class="anchor" id="sec_as3911RfidCom_2"></a>
Frame Delay Time</h2>
<p>The frame delay time is a forced delay between the end of the last message received from a card and the beginning of the next message send by the PCD.</p>
<p>If a frame delay time greater than zero is configured then <a class="el" href="group__as3911_rfid_com.html#ga091e236e2616c27fc0dae74830e8128b" title="Transmit a message with the AS3911.">as3911Transmit()</a> and <a class="el" href="group__as3911_rfid_com.html#gab596cd3ffe9750f715924103a96c8ab6" title="Send an RFID message and receive a card response.">as3911Transceive()</a> make sure that this frame delay time is kept. If necessary they will wait with starting the data transmission until the set frame delay time has passed.</p>
<p>If no card response was received after the last message transmitted by the PCD (<a class="el" href="group__as3911_rfid_com.html#gaaa5ae01bbb3e5f295dd393ebec21c84a" title="Receive a card response.">as3911Receive()</a> or <a class="el" href="group__as3911_rfid_com.html#gab596cd3ffe9750f715924103a96c8ab6" title="Send an RFID message and receive a card response.">as3911Transceive()</a> returned with a timeout error), then no frame delay time will be applied to the next data transmission.</p>
<h2><a class="anchor" id="sec_as3911RfidCom_3"></a>
Receive Timeout</h2>
<p>The receive timeout specifies the time the AS3911 will wait for a card response after it has completed the transmission of the reader message. After the receive timeout expires the receiver will be disabled internally and no further card responses can be received. If a receive timeout occures while a reception is in progress, then this reception continues until the message from the card has been completely received. So the receive timeout specifies a timeout for the start of the response from the RFID card.</p>
<p>If as3911Transceive is used then the receive timeout can be specified as a paramter to the functino call. If <a class="el" href="group__as3911_rfid_com.html#ga091e236e2616c27fc0dae74830e8128b" title="Transmit a message with the AS3911.">as3911Transmit()</a> and <a class="el" href="group__as3911_rfid_com.html#gaaa5ae01bbb3e5f295dd393ebec21c84a" title="Receive a card response.">as3911Receive()</a> are used seperately then the receive timeout must be set via <a class="el" href="group__as3911_rfid_com.html#ga1468a4d14877ba98080064a0feaea299" title="Set the receive timeout.">as3911SetReceiveTimeout()</a> prior to the call to <a class="el" href="group__as3911_rfid_com.html#ga091e236e2616c27fc0dae74830e8128b" title="Transmit a message with the AS3911.">as3911Transmit()</a>.</p>
<p>The currently active receive timeout is used until a new receive timeout is set.</p>
<h2><a class="anchor" id="sec_as3911RfidCom_4"></a>
Error Handling</h2>
<p>To support EMV special error handling capabilities are build into the AS3911 RFID communication code.</p>
<p>If EMV error handling is disabled, then no special error handling takes place and any reception errors are reported via the return values of <a class="el" href="group__as3911_rfid_com.html#ga091e236e2616c27fc0dae74830e8128b" title="Transmit a message with the AS3911.">as3911Transmit()</a> and <a class="el" href="group__as3911_rfid_com.html#gab596cd3ffe9750f715924103a96c8ab6" title="Send an RFID message and receive a card response.">as3911Transceive()</a> respectively.</p>
<p>If EMV error handling is enabled then a second parameter defines the details of the error handling namely the transmission error threshold. If a transmission error (parity error, crc error, error, data encoding error, or frame timing error)occures during reception of a frame whose overall length is less than or equal to the tranmsission error threshold, then this received frame is ignored and the receiver is reenabled to receive another card response. Also when EMV error handling is enabled then any frame with residual bits will be ignored no matter how long that frame was.</p>
<p>This is handled transparent to the caller. I.e. the caller will not be informed that an errornous frame has been ignored. Instead he will either get a timeout error reported if no further frame follows the ingored frame, or he will be informed about the content and error status of any frame received subsequent to the ignored one.</p>
<p>The transmission error threshold is compared against the received message length as reported by the AS3911. This length may or may not include the CRC bytes depending on the selected CRC processing mode (see usage of <a class="el" href="group__as3911_rfid_com.html#ga32470d661d8a69007b40eb27eaec270a">AS3911RequestFlags_t</a> in <a class="el" href="group__as3911_rfid_com.html#gab596cd3ffe9750f715924103a96c8ab6" title="Send an RFID message and receive a card response.">as3911Transceive()</a>).</p>
<h2><a class="anchor" id="sec_as3911RfidCom_5"></a>
Modulation Depth Adjustment</h2>
<p>The AS3911 RFID communication module can adjust the modulation depth for the PCD to PICC communication basedon the the measured RF amplitude (on the RFI pins) or on the phase difference between the RFO and RFI pins. Both of these parameters depend on the coupling between the PCD and PICC antennas. So this provides a method to adjust the modulation depth based on the strength of the coupling between the PCD and PICC.</p>
<p>To adjust the modulation depth, the selected parameter is measured and then a table lookup is performed to derive the apropriate RF modulation on driver level. This lookup table defines a piece wise linear function. I.e. if the measured paramter value is not found in the table then a linear interpolation between the two closest values is performed. If the measured parameter value is out of the table range (either lower than the smallest x table value or higher than the highest x table value), then the RF on modulation driver level associated with the lowest or highest table entry is used.</p>
<p>The modulation depth adjustment mode and the lookup table can be configured via <a class="el" href="group__as3911_rfid_com.html#gae6c139a8464ba6132483416c2c5617f6" title="Set the modulation level adjustment mode and modulation level adjustment table.">as3911SetModulationLevelMode()</a>. An adjustment of the modulation depth can be performed at any time by a call to <a class="el" href="group__as3911_rfid_com.html#ga59f2eddf2fefc3ee4b4a9cb46312ec36" title="Adjust the modulation level.">as3911AdjustModulationLevel()</a>. This adjustment is done automatically when <a class="el" href="group__as3911_rfid_com.html#ga091e236e2616c27fc0dae74830e8128b" title="Transmit a message with the AS3911.">as3911Transmit()</a> or <a class="el" href="group__as3911_rfid_com.html#gab596cd3ffe9750f715924103a96c8ab6" title="Send an RFID message and receive a card response.">as3911Transceive()</a> is called.</p>
<h2><a class="anchor" id="sec_as3911RfidCom_6"></a>
Data Transmission and Reception</h2>
<p>Data can be transceived either by using <a class="el" href="group__as3911_rfid_com.html#ga091e236e2616c27fc0dae74830e8128b" title="Transmit a message with the AS3911.">as3911Transmit()</a> and <a class="el" href="group__as3911_rfid_com.html#gaaa5ae01bbb3e5f295dd393ebec21c84a" title="Receive a card response.">as3911Receive()</a> directly as a two step process or by calling <a class="el" href="group__as3911_rfid_com.html#gab596cd3ffe9750f715924103a96c8ab6" title="Send an RFID message and receive a card response.">as3911Transceive()</a>. The later of which will perform the complete transmit and receive opertion and also allows to specify some additional options not available when using <a class="el" href="group__as3911_rfid_com.html#ga091e236e2616c27fc0dae74830e8128b" title="Transmit a message with the AS3911.">as3911Transmit()</a> and <a class="el" href="group__as3911_rfid_com.html#gaaa5ae01bbb3e5f295dd393ebec21c84a" title="Receive a card response.">as3911Receive()</a> separately.</p>
<p>If the two step approach is used then care must be taken that <a class="el" href="group__as3911_rfid_com.html#gaaa5ae01bbb3e5f295dd393ebec21c84a" title="Receive a card response.">as3911Receive()</a> is called in time not to loose any data received from the PICC. Also the user must then take care that any necessary interupts are enabled. The necessary interrupts are <a class="el" href="group__as3911_irq_handling.html#ga5deaa952f28651eac7d21299a85efb02">AS3911_IRQ_MASK_TXE</a> and <a class="el" href="group__as3911_irq_handling.html#gad610e4c3990fdf453ce240938b47b133">AS3911_IRQ_MASK_WL</a> for <a class="el" href="group__as3911_rfid_com.html#ga091e236e2616c27fc0dae74830e8128b" title="Transmit a message with the AS3911.">as3911Transmit()</a>, and <a class="el" href="group__as3911_irq_handling.html#gaea4beb4c29b18389495339fec430cf42">AS3911_IRQ_MASK_RXS</a>, <a class="el" href="group__as3911_irq_handling.html#gaaf670b45c3b57d8551ca78d93f6869c4">AS3911_IRQ_MASK_RXE</a>, and <a class="el" href="group__as3911_irq_handling.html#gad610e4c3990fdf453ce240938b47b133">AS3911_IRQ_MASK_WL</a> for data reception with <a class="el" href="group__as3911_rfid_com.html#gaaa5ae01bbb3e5f295dd393ebec21c84a" title="Receive a card response.">as3911Receive()</a>. Additionally error interrupts should be enabled as needed. </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="gae766a917d30b44c1ea06e5462edcef2a"></a><!-- doxytag: member="as3911_com.h::AS3911_TX_MODE_MASK" ref="gae766a917d30b44c1ea06e5462edcef2a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AS3911_TX_MODE_MASK&#160;&#160;&#160;0x30</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Bitmask for the bits defining the transmission mode inside the AS3911RequestFlags_t type. </p>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="ga671e939efb1421cb4a1583c12e1d8a43"></a><!-- doxytag: member="as3911_gain_adjustment.h::AS3911GainMode_t" ref="ga671e939efb1421cb4a1583c12e1d8a43" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__as3911_rfid_com.html#ga671e939efb1421cb4a1583c12e1d8a43">AS3911GainMode_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Available gain adjustment modes. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga671e939efb1421cb4a1583c12e1d8a43ad7364a5efee4569a97db08a1a95269af"></a><!-- doxytag: member="AS3911_GAIN_FIXED" ref="gga671e939efb1421cb4a1583c12e1d8a43ad7364a5efee4569a97db08a1a95269af" args="" -->AS3911_GAIN_FIXED</em>&nbsp;</td><td>
<p>No dynamic gain adjustment. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga671e939efb1421cb4a1583c12e1d8a43a768f873e2062370490a3903d05c22c1f"></a><!-- doxytag: member="AS3911_GAIN_FROM_AMPLITUDE" ref="gga671e939efb1421cb4a1583c12e1d8a43a768f873e2062370490a3903d05c22c1f" args="" -->AS3911_GAIN_FROM_AMPLITUDE</em>&nbsp;</td><td>
<p>Gain is adjusted based on RF amplitude. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga671e939efb1421cb4a1583c12e1d8a43a51bd9b23e5e35d6eb360609ea02588f5"></a><!-- doxytag: member="AS3911_GAIN_FROM_PHASE" ref="gga671e939efb1421cb4a1583c12e1d8a43a51bd9b23e5e35d6eb360609ea02588f5" args="" -->AS3911_GAIN_FROM_PHASE</em>&nbsp;</td><td>
<p>Gain is adjusted based on RFI, RFO signal phase difference. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga9860369f946c6932c18c7ca07da4351a"></a><!-- doxytag: member="as3911_modulation_adjustment.h::AS3911ModulationLevelMode_t" ref="ga9860369f946c6932c18c7ca07da4351a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__as3911_rfid_com.html#ga9860369f946c6932c18c7ca07da4351a">AS3911ModulationLevelMode_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Available modulation level adjustment modes. </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga9860369f946c6932c18c7ca07da4351aaef82d2fdbe886a114cdd7f50302a36e2"></a><!-- doxytag: member="AS3911_MODULATION_LEVEL_FIXED" ref="gga9860369f946c6932c18c7ca07da4351aaef82d2fdbe886a114cdd7f50302a36e2" args="" -->AS3911_MODULATION_LEVEL_FIXED</em>&nbsp;</td><td>
<p>No dynamic modulation level adjustment. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga9860369f946c6932c18c7ca07da4351aabebd3fbbed15281de23f5c4b650ee0e0"></a><!-- doxytag: member="AS3911_MODULATION_LEVEL_AUTOMATIC" ref="gga9860369f946c6932c18c7ca07da4351aabebd3fbbed15281de23f5c4b650ee0e0" args="" -->AS3911_MODULATION_LEVEL_AUTOMATIC</em>&nbsp;</td><td>
<p>Modulation level set with AS3911 automatic adjustment. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga9860369f946c6932c18c7ca07da4351aa7ec5c4a050a4e8c525b8e413562ddad0"></a><!-- doxytag: member="AS3911_MODULATION_LEVEL_FROM_AMPLITUDE" ref="gga9860369f946c6932c18c7ca07da4351aa7ec5c4a050a4e8c525b8e413562ddad0" args="" -->AS3911_MODULATION_LEVEL_FROM_AMPLITUDE</em>&nbsp;</td><td>
<p>Modulation level is adjusted based on RF amplitude. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga9860369f946c6932c18c7ca07da4351aafcd0372b3b3ed3685d23f981df8b5e55"></a><!-- doxytag: member="AS3911_MODULATION_LEVEL_FROM_PHASE" ref="gga9860369f946c6932c18c7ca07da4351aafcd0372b3b3ed3685d23f981df8b5e55" args="" -->AS3911_MODULATION_LEVEL_FROM_PHASE</em>&nbsp;</td><td>
<p>Modulation level is adjusted based on RFI, RFO signal phase difference. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<a class="anchor" id="ga32470d661d8a69007b40eb27eaec270a"></a><!-- doxytag: member="as3911_com.h::AS3911RequestFlags_t" ref="ga32470d661d8a69007b40eb27eaec270a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__as3911_rfid_com.html#ga32470d661d8a69007b40eb27eaec270a">AS3911RequestFlags_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Option flags for as3911Transmit and as3911Transceive </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga32470d661d8a69007b40eb27eaec270aa316a0aa780696ddc0c26d2e11ccb3a6b"></a><!-- doxytag: member="AS3911_IGNORE_CRC" ref="gga32470d661d8a69007b40eb27eaec270aa316a0aa780696ddc0c26d2e11ccb3a6b" args="" -->AS3911_IGNORE_CRC</em>&nbsp;</td><td>
<p>Do not perform a CRC check for received messages. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga32470d661d8a69007b40eb27eaec270aadaace36ce9d80237e0b35318e50e53f2"></a><!-- doxytag: member="AS3911_CRC_TO_FIFO" ref="gga32470d661d8a69007b40eb27eaec270aadaace36ce9d80237e0b35318e50e53f2" args="" -->AS3911_CRC_TO_FIFO</em>&nbsp;</td><td>
<p>Perform a CRC check on received messages and store the received CRC in the FIFO. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga32470d661d8a69007b40eb27eaec270aa74a61ad6aaecc3cad698b98303c3b47a"></a><!-- doxytag: member="AS3911_TRANSMIT_WITH_CRC" ref="gga32470d661d8a69007b40eb27eaec270aa74a61ad6aaecc3cad698b98303c3b47a" args="" -->AS3911_TRANSMIT_WITH_CRC</em>&nbsp;</td><td>
<p>Append a CRC to the transmitted message. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga32470d661d8a69007b40eb27eaec270aa5d5ea41fd31378138529c3f5ae62d95d"></a><!-- doxytag: member="AS3911_TRANSMIT_WITHOUT_CRC" ref="gga32470d661d8a69007b40eb27eaec270aa5d5ea41fd31378138529c3f5ae62d95d" args="" -->AS3911_TRANSMIT_WITHOUT_CRC</em>&nbsp;</td><td>
<p>Do not append a CRC to the transmitted message. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga32470d661d8a69007b40eb27eaec270aac9767e939ce3a47803fced5fba7439a5"></a><!-- doxytag: member="AS3911_TRANSMIT_REQA" ref="gga32470d661d8a69007b40eb27eaec270aac9767e939ce3a47803fced5fba7439a5" args="" -->AS3911_TRANSMIT_REQA</em>&nbsp;</td><td>
<p>Transmit a REQA ISO14443-A short frame. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga32470d661d8a69007b40eb27eaec270aa1e872266a5d5bec8fdbeb6fcf0824ae9"></a><!-- doxytag: member="AS3911_TRANSMIT_WUPA" ref="gga32470d661d8a69007b40eb27eaec270aa1e872266a5d5bec8fdbeb6fcf0824ae9" args="" -->AS3911_TRANSMIT_WUPA</em>&nbsp;</td><td>
<p>Transmit a WUPA ISO14443-A short frame. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga56e33e574960a4ab4572064d8e7dd5e2"></a><!-- doxytag: member="as3911_gain_adjustment.h::as3911AdjustGain" ref="ga56e33e574960a4ab4572064d8e7dd5e2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void as3911AdjustGain </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adjust the modualtion level based on the active modulation level adjustment mode and the modulation level adjustment table.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This method may block for up to 50 microseconds depending on the active modulation level adjustment mode. </dd></dl>

</div>
</div>
<a class="anchor" id="ga59f2eddf2fefc3ee4b4a9cb46312ec36"></a><!-- doxytag: member="as3911_modulation_adjustment.h::as3911AdjustModulationLevel" ref="ga59f2eddf2fefc3ee4b4a9cb46312ec36" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void as3911AdjustModulationLevel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adjust the modualtion level based on the active modulation level adjustment mode and the modulation level adjustment table.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This method may block for up to 50 microseconds depending on the active modulation level adjustment mode. </dd></dl>

</div>
</div>
<a class="anchor" id="gaaed8c0af2b459d1a94d13cf8075215c8"></a><!-- doxytag: member="as3911_com.h::as3911EmvExceptionProcessingIsEnabled" ref="gaaed8c0af2b459d1a94d13cf8075215c8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool_t as3911EmvExceptionProcessingIsEnabled </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>true: EMV layer 4 exception processing is enabled. </dd>
<dd>
false: EMV layer 4 exception processing is disabled. </dd></dl>

</div>
</div>
<a class="anchor" id="ga2a2791dbde4538fa3c4b1385e965e0f4"></a><!-- doxytag: member="as3911_com.h::as3911EnableEmvExceptionProcessing" ref="ga2a2791dbde4538fa3c4b1385e965e0f4" args="(bool_t enableEmvExceptionProcessing)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void as3911EnableEmvExceptionProcessing </td>
          <td>(</td>
          <td class="paramtype">bool_t&#160;</td>
          <td class="paramname"><em>enableEmvExceptionProcessing</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Enable or disable reception error processing as required by the EMV standard for a PICC that has been activated.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">enableEmvExceptionProcessing</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga1801b0e48a172ef7b511ee6b425bd774"></a><!-- doxytag: member="as3911_com.h::as3911GetFrameDelayTime" ref="ga1801b0e48a172ef7b511ee6b425bd774" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u32 as3911GetFrameDelayTime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>The frame delay time currently used. </dd></dl>

</div>
</div>
<a class="anchor" id="gaed0aaed5127ece136aa71cfeb08edd81"></a><!-- doxytag: member="as3911_gain_adjustment.h::as3911GetGainMode" ref="gaed0aaed5127ece136aa71cfeb08edd81" args="(AS3911GainMode_t *modulationLevelMode, const AS3911GainTable_t *modulationLevelTable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void as3911GetGainMode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__as3911_rfid_com.html#ga671e939efb1421cb4a1583c12e1d8a43">AS3911GainMode_t</a> *&#160;</td>
          <td class="paramname"><em>modulationLevelMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_a_s3911_gain_table__t.html">AS3911GainTable_t</a> *&#160;</td>
          <td class="paramname"><em>modulationLevelTable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">modulationLevelMode</td><td>Set to the active modulation level adjustment mode </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">modulationLevelTable</td><td>Set to the active modulation level adjustment table. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga23beb860bf4bfcd8ccfe829a6d9433d5"></a><!-- doxytag: member="as3911_modulation_adjustment.h::as3911GetModulationLevelMode" ref="ga23beb860bf4bfcd8ccfe829a6d9433d5" args="(AS3911ModulationLevelMode_t *modulationLevelMode, const void *modulationLevelModeData)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void as3911GetModulationLevelMode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__as3911_rfid_com.html#ga9860369f946c6932c18c7ca07da4351a">AS3911ModulationLevelMode_t</a> *&#160;</td>
          <td class="paramname"><em>modulationLevelMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>modulationLevelModeData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">modulationLevelMode</td><td>Set to the active modulation level adjustment mode </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">modulationLevelTable</td><td>Set to the active modulation level adjustment table. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gadcc0b5c5239d5d6310784afdfdf4abae"></a><!-- doxytag: member="as3911_com.h::as3911GetTransmissionErrorThreshold" ref="gadcc0b5c5239d5d6310784afdfdf4abae" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t as3911GetTransmissionErrorThreshold </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>The transmission error threshold. </dd></dl>

</div>
</div>
<a class="anchor" id="gaaa5ae01bbb3e5f295dd393ebec21c84a"></a><!-- doxytag: member="as3911_com.h::as3911Receive" ref="gaaa5ae01bbb3e5f295dd393ebec21c84a" args="(u8 *response, size_t maxResponseLength, size_t *responseLength)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">s16 as3911Receive </td>
          <td>(</td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>maxResponseLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>responseLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="note"><dt><b>Note:</b></dt><dd>The RFID protocol, datarates, and the rx_en bit have to be set prior to calling this function.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">response</td><td>Buffer to store the received message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxResponseLength</td><td>Size of the buffer <em>response</em> in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">responseLength</td><td>Set to the length of the received message in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>AS3911_TIMEOUT_ERROR: No card response was received during the reception timeout (as3911SetReceiveTimeout). </dd>
<dd>
COLLISION_ERROR: A bit collision was detected in the card response. </dd>
<dd>
AS3911_SOFT_FRAMING_ERROR: Card response had a soft framing error. </dd>
<dd>
AS3911_HARD_FRAMING_ERROR: Card respnose had a hard framing error. </dd>
<dd>
AS3911_CRC_ERROR: Card response had a crc error. </dd>
<dd>
AS3911_PARTIY_ERROR: Card response had a parity error. </dd>
<dd>
AS3911_OVERFLOW_ERROR: AS3911 FIFO or receive buffer overflow. </dd>
<dd>
AS3911_NO_ERROR: No error, received an error free card response. </dd></dl>

</div>
</div>
<a class="anchor" id="ga0be2f5f914a6adace78a4b103f514edc"></a><!-- doxytag: member="as3911_com.h::as3911SetFrameDelayTime" ref="ga0be2f5f914a6adace78a4b103f514edc" args="(u32 frameDelayTime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void as3911SetFrameDelayTime </td>
          <td>(</td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>frameDelayTime</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The frame delay time defines the minimum delay between the last message received from the PICC and the next message send by the PCD. If there was no response to the last message send by the reader then no frame delay time is applied to the next message send by the reader.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">frameDelayTime</td><td>The frame delay time in carrier cycles. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gac9b5a16174fa4e610a79c21f4f47e8d6"></a><!-- doxytag: member="as3911_gain_adjustment.h::as3911SetGainMode" ref="gac9b5a16174fa4e610a79c21f4f47e8d6" args="(AS3911GainMode_t modulationLevelMode, const AS3911GainTable_t *modulationLevelTable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void as3911SetGainMode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__as3911_rfid_com.html#ga671e939efb1421cb4a1583c12e1d8a43">AS3911GainMode_t</a>&#160;</td>
          <td class="paramname"><em>modulationLevelMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_a_s3911_gain_table__t.html">AS3911GainTable_t</a> *&#160;</td>
          <td class="paramname"><em>modulationLevelTable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the modualtion level adjustment mode and configure additional data needed by some of the adjustment modes. There are three modes available:</p>
<p>AS3911_MODULATION_LEVEL_FIXED: no dynamic adjustment of the modulation level is performed. The <em>modulationLevelTable</em> parameter will be ignored.</p>
<p>AS3911_MODULATION_LEVEL_FROM_AMPLITUDE: The modulation level is adjusted based on the RF amplitude and the lookup table values in <em>modulationLevelTable</em>.</p>
<p>AS3911_MODULATION_LEVEL_FROM_PHASE: The modulation level is adjusted based on the phase difference between RFI and RFO signals and the lookup table values in <em>modulationLevelTable</em>.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Internally only a pointer to the modulationLevelTable will be stored. The data structure pointed to by <em>modulationLevelTable</em> should therefore not be modified while in use by this module.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">modulationLevelMode</td><td>Set the modulation level adjustment mode. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">modulationLevelTable</td><td>Set the modulation level lookup table to be used in the AS3911_MODULATION_LEVEL_FROM_AMPLITUDE and AS3911_MODULATION_LEVEL_FROM_PHASE modes. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gae6c139a8464ba6132483416c2c5617f6"></a><!-- doxytag: member="as3911_modulation_adjustment.h::as3911SetModulationLevelMode" ref="gae6c139a8464ba6132483416c2c5617f6" args="(AS3911ModulationLevelMode_t modulationLevelMode, const void *modulationLevelModeData)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void as3911SetModulationLevelMode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__as3911_rfid_com.html#ga9860369f946c6932c18c7ca07da4351a">AS3911ModulationLevelMode_t</a>&#160;</td>
          <td class="paramname"><em>modulationLevelMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>modulationLevelModeData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the modualtion level adjustment mode and configure additional data needed by some of the adjustment modes. There are three modes available:</p>
<p>AS3911_MODULATION_LEVEL_FIXED: no dynamic adjustment of the modulation level is performed. The <em>modulationLevelTable</em> parameter will be ignored.</p>
<p>AS3911_MODULATION_LEVEL_AUTOMATIC: Use the AS3911 automatic modulation depth adjustment to set the modulation depth.</p>
<p>AS3911_MODULATION_LEVEL_FROM_AMPLITUDE: The modulation level is adjusted based on the RF amplitude and the lookup table values in <em>modulationLevelModeData</em>.</p>
<p>AS3911_MODULATION_LEVEL_FROM_PHASE: The modulation level is adjusted based on the phase difference between RFI and RFO signals and the lookup table values in <em>modulationLevelModeData</em>.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Internally only a pointer to the modulationLevelModeData will be stored. The data structure pointed to by <em>modulationLevelModeData</em> should therefore not be modified while in use by this module.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">modulationLevelMode</td><td>Set the modulation level adjustment mode. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">modulationLevelModeData</td><td>Additional data for the selected modulation level adjustment mode. This must be of the following datatype: AS3911_MODULATION_LEVEL_FIXED: no additional data required, can be NULL. AS3911_MODULATION_LEVEL_AUTOMATIC: Pointer to AS3911ModulationLevelAutomaticAdjustmentData_t. AS3911_MODULATION_LEVEL_FROM_AMPLITUDE: Pointer to <a class="el" href="struct_a_s3911_modulation_level_table__t.html" title="Modulation level adjustment lookup table.">AS3911ModulationLevelTable_t</a>. AS3911_MODULATION_LEVEL_FROM_PHASE: Pointer to <a class="el" href="struct_a_s3911_modulation_level_table__t.html" title="Modulation level adjustment lookup table.">AS3911ModulationLevelTable_t</a>.</td></tr>
  </table>
  </dd>
</dl>
<p>AS3911_MODULATION_LEVEL_FROM_PHASE modes. </p>

</div>
</div>
<a class="anchor" id="gaf9dd8ab1205585eb78b26d2d426012e1"></a><!-- doxytag: member="as3911_com.h::as3911SetReceiverDeadtime" ref="gaf9dd8ab1205585eb78b26d2d426012e1" args="(u32 receiverDeadtime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void as3911SetReceiverDeadtime </td>
          <td>(</td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>receiverDeadtime</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The receiver dead time is the time for which the receiver is still disabled after the end of the message send by the AS3911. The as3911 will not process any card response received during the receiver dead time.</p>
<p>In NFCIP1 mode the receiver deadtime has a granularity of 512 carrier cycles and ranges from ?? to 130560 carrier cycles (~9.3ms). In all other modes the receiver deadtime has a granularity of 64 carrier cycles and ranges from 256 to 16320 carrier cycles (~1.2ms). Using values below the minimum value will lead to the minimum value being used. Using values above the maximum allowed value leads to undefined behavior.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">receiverDeadtime</td><td>Receiver deadtime in carrier cycles. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga1468a4d14877ba98080064a0feaea299"></a><!-- doxytag: member="as3911_com.h::as3911SetReceiveTimeout" ref="ga1468a4d14877ba98080064a0feaea299" args="(u32 receiveTimeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void as3911SetReceiveTimeout </td>
          <td>(</td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>receiveTimeout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set the receive timeout (no-response timer) for AS3911 card response reception. The given receive timeout value is rounded up to the next higher value which can be configured in the AS3911.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">receiveTimeout</td><td>Receive timeout in carrier cycles. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gaf2d2dc0feff4753677465ac25b69df77"></a><!-- doxytag: member="as3911_com.h::as3911SetTransmissionErrorThreshold" ref="gaf2d2dc0feff4753677465ac25b69df77" args="(size_t transmissionErrorThreshold)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void as3911SetTransmissionErrorThreshold </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>transmissionErrorThreshold</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If EMV exception processing is enabled, then all messages with a transmission error (CRC error, parity error, residual bits error) and an overall length lower than or equal to the transmission error threshold will be ignored.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">transmissionErrorThreshold</td><td>Transmission error threshold (bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gab596cd3ffe9750f715924103a96c8ab6"></a><!-- doxytag: member="as3911_com.h::as3911Transceive" ref="gab596cd3ffe9750f715924103a96c8ab6" args="(const u8 *request, size_t requestLength, u8 *response, size_t maxResponseLength, size_t *responseLength, u32 timeout, AS3911RequestFlags_t requestFlags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">s16 as3911Transceive </td>
          <td>(</td>
          <td class="paramtype">const u8 *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>requestLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>maxResponseLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>responseLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u32&#160;</td>
          <td class="paramname"><em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__as3911_rfid_com.html#ga32470d661d8a69007b40eb27eaec270a">AS3911RequestFlags_t</a>&#160;</td>
          <td class="paramname"><em>requestFlags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">request</td><td>Pointer to the request. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">requestLength</td><td>Length of the request in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">response</td><td>Buffer to store the card response. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxResponseLength</td><td>Size of the response buffer <em>response</em> in byets. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">responseLength</td><td>Set to the length of the recieved response in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout</td><td>Receive timeout in carrier cycles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">requestFlags</td><td>Request flags. <br/>
 default: Append CRC to the transmitted message, check the crc of the received message, and do not put the received CRC into the FIFO. <br/>
 AS3911_IGNORE_CRC: Do not perform a CRC check on the received messages. The complete received message is stored in the FIFO. <br/>
 AS3911_CRC_TO_FIFO: Perform a CRC check on received messages and store the compelte received message (including the CRC bytes) in the FIFO. <br/>
 AS3911_TRANSMIT_WITH_CRC: Append a CRC to the transmitted message. AS3911_TRANSMIT_WITHOUT_CRC: Do not append a CRC to the transmitted message. <br/>
 AS3911_TRANSMIT_REQA: Transmit a REQA ISO14443-A short frame. The given request message will be ignored. <br/>
 AS3911_TRANSMIT_WUPA: Transmit a WUPA ISO14443-A short frame. The given request messag will be ignored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>See as3911Receive for a description of the return values. </dd></dl>

</div>
</div>
<a class="anchor" id="ga091e236e2616c27fc0dae74830e8128b"></a><!-- doxytag: member="as3911_com.h::as3911Transmit" ref="ga091e236e2616c27fc0dae74830e8128b" args="(const u8 *message, size_t messageLength, AS3911RequestFlags_t requestFlags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void as3911Transmit </td>
          <td>(</td>
          <td class="paramtype">const u8 *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>messageLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__as3911_rfid_com.html#ga32470d661d8a69007b40eb27eaec270a">AS3911RequestFlags_t</a>&#160;</td>
          <td class="paramname"><em>requestFlags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="note"><dt><b>Note:</b></dt><dd>The RFID protocol, datarates, and the tx_en bit have to be setup prior to calling this function.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">message</td><td>The message to transmit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">messageLength</td><td>Length of the message in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">requestFlags</td><td>If the AS3911_TRANSMIT_WITHOUT_CRC flag is set then the transmission will occure without CRC otherwise an automatically calculated CRC is appended to the transmitted message. All other flags are ignored. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Apr 17 2012 12:33:40 for AS3911 EMV L1 Certification Firmware by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
